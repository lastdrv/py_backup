Утилита для резервного копирования баз MySql / MariaDB потаблично




Поступившее ТЗ


Каждый день для каждой базы:

  "Дампинг"
  =========
  Проверяем, сколько дампов есть по этой базе.
    Если больше одного, то:
      Берём дату изменения всех таблиц (файлов) базы.
      Сравниваем даты с последними.
        Если изменений нет, то:
          Предыдущий файл дампа считается актуальным.
    В остальных случаях (дампов меньше двух, последний дамп не актуален):
      Дампим таблицы базы (кроме списка исключений таблиц) в файл, он считается актуальным.
      Файл сжимаем, называем примерно <db>_<date>.sql.xz

  Удаление
  =======
  Оставляем дампы.
    Актуальный (последний)
    Самый ранний дамп за текущий месяц.
    За предыдущий месяц.

Для неменяющихся баз будет будет 2 дампа (на всякий пожарный, лучше чем 12).
Для активных баз в любой момент времени будет 3 дампа, из них один актуальный, один с "возрастом" от одного до двух месяцев, один промежуточный.
В принципе, для активных баз 3 дампа - это не много.